'''
Created on 29 Dec 2016

@author: 611370417
'''

import cx_Oracle

def make_Connection() :
    con = cx_Oracle.connect('sparkmaya/sparkmaya@127.0.0.1/XE')
    print con.version
    cur = con.cursor()
    connection = cur.execute('select * from connection_detail where valid_connection=0')
    
    if len(con.version)>0:
        print("Connection Valid..")
        for result in cur:
            print "Updating %s wth valid_conection=1" %(result[7])
            cur.execute("update connection_detail set valid_connection=1 where id=" %(result[0]))
            con.commit;
            print result

    cur.close()
    con.close()




if __name__ == '__main__':
    make_Connection()